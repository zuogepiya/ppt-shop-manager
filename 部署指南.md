# PPTåˆ¶ä½œåº—é“ºç®¡ç†ç³»ç»Ÿ - å…¬ç½‘éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—æä¾›å¤šç§éƒ¨ç½²æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ å°†ç³»ç»Ÿéƒ¨ç½²åˆ°å…¬ç½‘ï¼Œè®©è®¾è®¡å¸ˆå’Œå‘˜å·¥å¯ä»¥è¿œç¨‹è®¿é—®ã€‚

## æ–¹æ¡ˆä¸€ï¼šVercel éƒ¨ç½²ï¼ˆæ¨èï¼‰â­

### ä¼˜ç‚¹
- âœ… å…è´¹ã€å¿«é€Ÿã€è‡ªåŠ¨HTTPS
- âœ… å…¨çƒCDNåŠ é€Ÿ
- âœ… è‡ªåŠ¨éƒ¨ç½²å’Œå›æ»š
- âœ… æ— éœ€æœåŠ¡å™¨ç»´æŠ¤
- âœ… Next.jsåŸç”Ÿæ”¯æŒ

### ç¼ºç‚¹
- âŒ éœ€è¦é…ç½®å¤–éƒ¨æ•°æ®åº“
- âŒ æœåŠ¡å™¨ç¯å¢ƒå—é™ï¼ˆæ— æ³•ä½¿ç”¨WebSocketç­‰ï¼‰

### éƒ¨ç½²æ­¥éª¤

#### 1. å‡†å¤‡æ•°æ®åº“

æ¨èä½¿ç”¨å…è´¹çš„äº‘æ•°æ®åº“æœåŠ¡ï¼š

**Supabaseï¼ˆæ¨èï¼‰**
1. è®¿é—® https://supabase.com
2. æ³¨å†Œå¹¶åˆ›å»ºæ–°é¡¹ç›®
3. åœ¨ Project Settings > Database ä¸­è·å– Connection String
4. æ ¼å¼ï¼š`postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres`

**Neonï¼ˆå¤‡é€‰ï¼‰**
1. è®¿é—® https://neon.tech
2. æ³¨å†Œå¹¶åˆ›å»ºæ–°é¡¹ç›®
3. è·å– Connection String

#### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env.local` æ–‡ä»¶ï¼š

```bash
DATABASE_URL="postgresql://postgres:[YOUR-PASSWORD]@db.[PROJECT-REF].supabase.co:5432/postgres"
NODE_ENV="production"
```

#### 3. å‡†å¤‡éƒ¨ç½²ä»£ç 

ç¡®ä¿é¡¹ç›®ç»“æ„æ­£ç¡®ï¼š
- `package.json` åŒ…å« `build` å’Œ `start` è„šæœ¬
- æ‰€æœ‰ä¾èµ–å·²å®‰è£…

#### 4. æ¨é€ä»£ç åˆ° GitHub

```bash
git init
git add .
git commit -m "Initial commit"

# åˆ›å»ºGitHubä»“åº“å
git remote add origin https://github.com/your-username/ppt-shop-manager.git
git branch -M main
git push -u origin main
```

#### 5. éƒ¨ç½²åˆ° Vercel

1. è®¿é—® https://vercel.com å¹¶æ³¨å†Œ/ç™»å½•
2. ç‚¹å‡» "Add New Project"
3. å¯¼å…¥ä½ çš„ GitHub ä»“åº“
4. é…ç½®ç¯å¢ƒå˜é‡ï¼š
   - Name: `DATABASE_URL`
   - Value: ä½ çš„æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
5. ç‚¹å‡» "Deploy"
6. ç­‰å¾…éƒ¨ç½²å®Œæˆï¼ˆçº¦1-2åˆ†é’Ÿï¼‰
7. éƒ¨ç½²æˆåŠŸåä¼šè·å¾—ä¸€ä¸ª `.vercel.app` åŸŸå

#### 6. åˆå§‹åŒ–æ•°æ®åº“

éƒ¨ç½²æˆåŠŸåï¼Œè®¿é—®ä»¥ä¸‹URLåˆå§‹åŒ–æ•°æ®åº“ï¼š

```
https://your-app.vercel.app/api/db-init
```

ç„¶åæ’å…¥æµ‹è¯•æ•°æ®ï¼š

```
https://your-app.vercel.app/api/test-data
```

#### 7. è‡ªå®šä¹‰åŸŸåï¼ˆå¯é€‰ï¼‰

åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­ï¼š
1. æ·»åŠ è‡ªå®šä¹‰åŸŸå
2. é…ç½®DNSè®°å½•ï¼ˆAè®°å½•æˆ–CNAMEï¼‰
3. è‡ªåŠ¨é…ç½®SSLè¯ä¹¦

---

## æ–¹æ¡ˆäºŒï¼šäº‘æœåŠ¡å™¨éƒ¨ç½²

### ä¼˜ç‚¹
- âœ… å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ç¯å¢ƒ
- âœ… å¯ä»¥å®‰è£…ä»»ä½•è½¯ä»¶
- âœ… é€‚åˆé•¿æœŸä½¿ç”¨
- âœ… æ€§èƒ½ç¨³å®š

### ç¼ºç‚¹
- âŒ éœ€è¦è´­ä¹°æœåŠ¡å™¨ï¼ˆçº¦50-200å…ƒ/æœˆï¼‰
- âŒ éœ€è¦é…ç½®æœåŠ¡å™¨ç¯å¢ƒ
- âŒ éœ€è¦æ‰‹åŠ¨ç»´æŠ¤

### æ¨èäº‘æœåŠ¡æä¾›å•†

| æä¾›å•† | èµ·æ­¥ä»·æ ¼ | æ¨èé…ç½® |
|--------|----------|----------|
| é˜¿é‡Œäº‘ | Â¥50/æœˆ | 2æ ¸4G |
| è…¾è®¯äº‘ | Â¥50/æœˆ | 2æ ¸4G |
| åä¸ºäº‘ | Â¥60/æœˆ | 2æ ¸4G |
| AWS | å…è´¹å¥—é¤12ä¸ªæœˆ | t2.micro |

### éƒ¨ç½²æ­¥éª¤

#### 1. è´­ä¹°äº‘æœåŠ¡å™¨

é€‰æ‹©é€‚åˆçš„äº‘æœåŠ¡å•†å’Œé…ç½®ï¼š
- æ“ä½œç³»ç»Ÿï¼šUbuntu 22.04 LTS
- é…ç½®ï¼š2æ ¸4Gï¼ˆæœ€ä½1æ ¸2Gï¼‰
- å¸¦å®½ï¼š1-3Mbps
- ç¡¬ç›˜ï¼š40GB SSD

#### 2. å®‰è£…å¿…è¦è½¯ä»¶

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…Node.js (Node 20)
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt install -y nodejs

# å®‰è£…pnpm
npm install -g pnpm

# å®‰è£…PostgreSQL
sudo apt install -y postgresql postgresql-contrib

# å®‰è£…Nginxï¼ˆåå‘ä»£ç†ï¼‰
sudo apt install -y nginx

# å®‰è£…PM2ï¼ˆè¿›ç¨‹ç®¡ç†ï¼‰
npm install -g pm2
```

#### 3. é…ç½®PostgreSQLæ•°æ®åº“

```bash
# åˆ‡æ¢åˆ°postgresç”¨æˆ·
sudo -u postgres psql

# åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
CREATE DATABASE ppt_shop;
CREATE USER ppt_user WITH PASSWORD 'your_secure_password';
GRANT ALL PRIVILEGES ON DATABASE ppt_shop TO ppt_user;
\q

# å…è®¸è¿œç¨‹è¿æ¥ï¼ˆä¿®æ”¹é…ç½®ï¼‰
sudo nano /etc/postgresql/14/main/pg_hba.conf

# åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š
host    all             all             0.0.0.0/0               md5

# é‡å¯PostgreSQL
sudo systemctl restart postgresql
```

#### 4. ä¸Šä¼ é¡¹ç›®ä»£ç 

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
cd /var/www
sudo git clone https://github.com/your-username/ppt-shop-manager.git
cd ppt-shop-manager

# å®‰è£…ä¾èµ–
pnpm install

# åˆ›å»ºç¯å¢ƒå˜é‡
sudo nano .env
```

`.env` æ–‡ä»¶å†…å®¹ï¼š
```bash
DATABASE_URL="postgresql://ppt_user:your_secure_password@localhost:5432/ppt_shop"
NODE_ENV="production"
PORT=3000
```

#### 5. æ„å»ºå’Œå¯åŠ¨åº”ç”¨

```bash
# æ„å»ºé¡¹ç›®
pnpm run build

# ä½¿ç”¨PM2å¯åŠ¨
pm2 start npm --name "ppt-shop" -- start

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

#### 6. é…ç½®Nginxåå‘ä»£ç†

```bash
sudo nano /etc/nginx/sites-available/ppt-shop
```

é…ç½®å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/ppt-shop /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

#### 7. é…ç½®SSLè¯ä¹¦ï¼ˆLet's Encryptï¼‰

```bash
# å®‰è£…Certbot
sudo apt install -y certbot python3-certbot-nginx

# è·å–SSLè¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

#### 8. é…ç½®é˜²ç«å¢™

```bash
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS
sudo ufw enable
```

---

## æ–¹æ¡ˆä¸‰ï¼šDocker éƒ¨ç½²ï¼ˆé€‚åˆå¿«é€Ÿéƒ¨ç½²ï¼‰

### ä¼˜ç‚¹
- âœ… ç¯å¢ƒä¸€è‡´æ€§å¥½
- âœ… æ˜“äºè¿ç§»å’Œæ‰©å±•
- âœ… å¿«é€Ÿéƒ¨ç½²

### éƒ¨ç½²æ­¥éª¤

#### 1. åˆ›å»º Dockerfile

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `Dockerfile`ï¼š

```dockerfile
FROM node:20-alpine AS base

# Install dependencies only when needed
FROM base AS deps
RUN apk add --no-cache libc6-compat
WORKDIR /app

COPY package.json pnpm-lock.yaml* ./
RUN npm install -g pnpm && pnpm install --frozen-lockfile

# Rebuild the source code only when needed
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .

ENV NEXT_TELEMETRY_DISABLED 1

RUN pnpm run build

# Production image, copy all the files and run next
FROM base AS runner
WORKDIR /app

ENV NODE_ENV production
ENV NEXT_TELEMETRY_DISABLED 1

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder --chown=nextjs:nodejs /app/.next/standalone ./
COPY --from=builder --chown=nextjs:nodejs /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000

ENV PORT 3000

CMD ["node", "server.js"]
```

#### 2. åˆ›å»º docker-compose.yml

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/ppt_shop
      - NODE_ENV=production
    depends_on:
      - db
    restart: unless-stopped

  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=ppt_shop
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

volumes:
  postgres_data:
```

#### 3. æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker-compose build

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

---

## æ–¹æ¡ˆå››ï¼šå†…ç½‘ç©¿é€ï¼ˆä¸´æ—¶æµ‹è¯•ç”¨ï¼‰

### é€‚åˆåœºæ™¯
- å¿«é€Ÿæ¼”ç¤ºç»™å®¢æˆ·
- ä¸´æ—¶æµ‹è¯•
- ä¸æƒ³è´­ä¹°æœåŠ¡å™¨

### å·¥å…·æ¨è

#### 1. ngrokï¼ˆç®€å•æ˜“ç”¨ï¼‰

```bash
# å®‰è£…ngrok
# è®¿é—® https://ngrok.com ä¸‹è½½

# å¯åŠ¨å†…ç½‘ç©¿é€
ngrok http 5000
```

ä¼šè·å¾—ä¸€ä¸ªä¸´æ—¶å…¬ç½‘åœ°å€ï¼Œå¦‚ï¼š`https://xxxx-xx-xx-xx-xx.ngrok-free.app`

#### 2. Cloudflare Tunnelï¼ˆå…è´¹ä¸”ç¨³å®šï¼‰

```bash
# å®‰è£…cloudflared
# è®¿é—® https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/

# ç™»å½•
cloudflared tunnel login

# åˆ›å»ºéš§é“
cloudflared tunnel create ppt-shop

# é…ç½®éš§é“
cloudflared tunnel route dns ppt-shop your-domain.com

# å¯åŠ¨éš§é“
cloudflared tunnel run ppt-shop
```

---

## éƒ¨ç½²åå¿…åšäº‹é¡¹

### 1. åˆå§‹åŒ–æ•°æ®åº“

æ— è®ºä½¿ç”¨å“ªç§éƒ¨ç½²æ–¹å¼ï¼Œé¦–æ¬¡è®¿é—®åéœ€è¦ï¼š

```bash
# åˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æ„
curl -X POST https://your-domain.com/api/db-init

# æ’å…¥æµ‹è¯•æ•°æ®
curl -X POST https://your-domain.com/api/test-data
```

### 2. ä¿®æ”¹é»˜è®¤å¯†ç 

ç™»å½•ç³»ç»Ÿåï¼Œç«‹å³ä¿®æ”¹æ‰€æœ‰æ¼”ç¤ºè´¦å·çš„å¯†ç ã€‚

### 3. é…ç½®å¤‡ä»½

- æ•°æ®åº“å®šæœŸå¤‡ä»½
- ä»£ç ç‰ˆæœ¬æ§åˆ¶
- é‡è¦æ•°æ®å¯¼å‡º

### 4. ç›‘æ§å’Œæ—¥å¿—

- é…ç½®åº”ç”¨ç›‘æ§ï¼ˆå¦‚Sentryï¼‰
- å®šæœŸæ£€æŸ¥æ—¥å¿—
- è®¾ç½®å‘Šè­¦

---

## æˆæœ¬å¯¹æ¯”

| æ–¹æ¡ˆ | æœˆè´¹ç”¨ | éš¾åº¦ | æ¨èåº¦ |
|------|--------|------|--------|
| Vercel | $0ï¼ˆæ•°æ®åº“å…è´¹ï¼‰ | â­ ç®€å• | â­â­â­â­â­ |
| äº‘æœåŠ¡å™¨ | Â¥50-200 | â­â­â­ ä¸­ç­‰ | â­â­â­â­ |
| Docker+äº‘æœåŠ¡å™¨ | Â¥50-200 | â­â­â­â­ å¤æ‚ | â­â­â­ |
| å†…ç½‘ç©¿é€ | Â¥0-20 | â­ ç®€å• | â­â­ |

---

## æ¨èæ–¹æ¡ˆé€‰æ‹©

### æ–°æ‰‹/å¿«é€Ÿä¸Šæ‰‹
â†’ **Vercel + Supabase**
- å…è´¹ã€å¿«é€Ÿã€è‡ªåŠ¨åŒ–éƒ¨ç½²
- é€‚åˆä¸ªäººæˆ–å°å›¢é˜Ÿ

### ä¼ä¸š/é•¿æœŸä½¿ç”¨
â†’ **äº‘æœåŠ¡å™¨ + PostgreSQL**
- å®Œå…¨æ§åˆ¶ã€æ€§èƒ½ç¨³å®š
- é€‚åˆä¼ä¸šç”Ÿäº§ç¯å¢ƒ

### å¼€å‘/æµ‹è¯•ç¯å¢ƒ
â†’ **Docker + ngrok**
- å¿«é€Ÿéƒ¨ç½²ã€æ˜“äºè¿ç§»
- é€‚åˆå¼€å‘å’Œæµ‹è¯•

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·ï¼š
1. æ£€æŸ¥æ—¥å¿—è¾“å‡º
2. ç¡®è®¤ç¯å¢ƒå˜é‡é…ç½®æ­£ç¡®
3. ç¡®è®¤æ•°æ®åº“è¿æ¥æ­£å¸¸
4. æ£€æŸ¥é˜²ç«å¢™å’Œç½‘ç»œè®¾ç½®

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€
